---
interface Props {
  totalItems: number;
  itemsPerPage: number;
  currentPage?: number;
}

const { totalItems, itemsPerPage, currentPage = 1 } = Astro.props;
const totalPages = Math.ceil(totalItems / itemsPerPage);
---

<nav class="pagination" data-total-pages={totalPages} data-items-per-page={itemsPerPage}>
  <button class="pagination-btn prev" disabled aria-label="Previous page">
    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <polyline points="15 18 9 12 15 6"></polyline>
    </svg>
    <span>Previous</span>
  </button>

  <div class="pagination-info">
    <span class="page-current">1</span>
    <span class="page-separator">of</span>
    <span class="page-total">{totalPages}</span>
  </div>

  <button class="pagination-btn next" aria-label="Next page">
    <span>Next</span>
    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </button>
</nav>

<style>
  .pagination {
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 1.5rem;
    margin-top: 3rem;
    padding: 1.5rem;
    background: rgba(var(--accent-dark), 0.5);
    border-radius: 12px;
  }

  .pagination-btn {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.75rem 1.25rem;
    font-size: 0.9rem;
    font-weight: 600;
    color: white;
    background: rgba(var(--accent), 0.3);
    border: 1px solid rgba(var(--accent-light), 0.3);
    border-radius: 8px;
    cursor: pointer;
    transition: all 0.2s ease;
  }

  .pagination-btn:hover:not(:disabled) {
    background: rgba(var(--accent), 0.5);
    border-color: rgba(var(--accent-light), 0.5);
    transform: translateY(-1px);
  }

  .pagination-btn:disabled {
    opacity: 0.4;
    cursor: not-allowed;
  }

  .pagination-btn svg {
    width: 18px;
    height: 18px;
  }

  .pagination-info {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    font-size: 1rem;
    color: rgba(255, 255, 255, 0.8);
  }

  .page-current {
    font-weight: 700;
    font-size: 1.25rem;
    color: rgb(var(--accent-light));
  }

  .page-separator {
    color: rgba(255, 255, 255, 0.5);
  }

  .page-total {
    font-weight: 600;
  }

  @media (max-width: 500px) {
    .pagination {
      gap: 1rem;
      padding: 1rem;
    }

    .pagination-btn span {
      display: none;
    }

    .pagination-btn {
      padding: 0.75rem;
    }
  }
</style>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    const pagination = document.querySelector('.pagination') as HTMLElement;
    if (!pagination) return;

    const totalPages = parseInt(pagination.dataset.totalPages || '1');
    const itemsPerPage = parseInt(pagination.dataset.itemsPerPage || '12');

    const prevBtn = pagination.querySelector('.prev') as HTMLButtonElement;
    const nextBtn = pagination.querySelector('.next') as HTMLButtonElement;
    const currentPageEl = pagination.querySelector('.page-current') as HTMLElement;
    const grid = document.querySelector('.logos-grid') as HTMLElement;
    const cards = Array.from(grid?.querySelectorAll('.logo-card') || []) as HTMLElement[];

    let currentPage = 1;

    function updateDisplay() {
      const start = (currentPage - 1) * itemsPerPage;
      const end = start + itemsPerPage;

      cards.forEach((card, index) => {
        if (index >= start && index < end) {
          card.style.display = '';
        } else {
          card.style.display = 'none';
        }
      });

      currentPageEl.textContent = currentPage.toString();
      prevBtn.disabled = currentPage === 1;
      nextBtn.disabled = currentPage === totalPages;

      // Scroll to top of grid
      grid?.scrollIntoView({ behavior: 'smooth', block: 'start' });
    }

    prevBtn?.addEventListener('click', () => {
      if (currentPage > 1) {
        currentPage--;
        updateDisplay();
      }
    });

    nextBtn?.addEventListener('click', () => {
      if (currentPage < totalPages) {
        currentPage++;
        updateDisplay();
      }
    });

    // Initial display
    updateDisplay();
  });
</script>
